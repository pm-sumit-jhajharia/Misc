<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Catalog Search Page</title>

	<!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script>
	$(document)
			.ready(
					function() {
						$('form')
						.submit(
								function(event) {
									var searchText = document
											.getElementById('searchText').value;
									var filterType = document
											.getElementById('filterType').value;
									if (searchText == null
											|| searchText.length == 0) {
										alert('Please enter seach text.');
										return false;
									}
									var url = "http://localhost/abcd.php?filterValue="+searchText+"&filterType="+filterType;
									var result={};
									$.ajax(
													{
														type : 'GET',
														url : url,
														async:false,
														dataType:'json'
													})
											.success(
													function(data) {
														result=data;
														//console.log(result);		
														//alert(result);
														logger(result);
														display(result);
														//display_catalogue(result);
													});
									event.preventDefault();
								});
						
					});
	
	function display(data){
		var htmlContent = "";
		var checkData=""+data+"";
		if (checkData.length > 0) {
			htmlContent += "<table class='table table-hover table-striped table-bordered'  style='margin-top: 20px'>" + 
						   "<tr>" +
								"<th style='width:3%;'>#</th>"+
								"<th style='width:17%;'>Email</th>"+
								"<th style='width:12%;'>Requestee</th>"+ 
								"<th>Description</th>" +
						   "</tr>";
			for (var i = 0; i < data.rows.length; i++) {
				htmlContent += "<tr>"+ 
									"<td >" + data.rows[i].caseId + "</td>" +
									"<td >" + data.rows[i].email	+ "</td>" + 
									"<td >" + data.rows[i].callerName + "</td>" + 
									"<td >" + data.rows[i].details + "</td>"+ 
								"</tr>";
			}
			htmlContent += "</table>";
			document
					.getElementById('renderSearch').innerHTML = htmlContent;
		} else {
			document
					.getElementById('renderSearch').innerHTML = '<span style="color: red">No Data Found<span>';
		}
	}
	function display_catalogue(data){
		var htmlContent = "";
		var checkData = "" + data + "";
		if (checkData.length > 0 ) {
			//htmlContent += "<div class='row'>";
                htmlContent += "<div class='col-sm-1' style='background-color:lavenderblush;font-weight: bold;'>" + "CaseId" + "</div>";
                htmlContent += "<div class='col-sm-2' style='background-color:lavenderblush;font-weight: bold;'>" + "Email" + "</div>";
                htmlContent += "<div class='col-sm-2' style='background-color:lavenderblush;font-weight: bold;'>" + "Requestee" + "</div>";
                htmlContent += "<div class='col-sm-7' style='background-color:lavenderblush;font-weight: bold;'>" + "Details" + "</div>";
			for(var i=0; i < data.rows.length; i++) {
				var bgcolor = '';
				if(i%2 == 0) {
					bgcolor += 'background-color:lavender;';
				}
				else {
					bgcolor += 'background-color:lavenderblush;';
				}
				htmlContent += "<div class='col-sm-1' style=" + bgcolor + ">" + data.rows[i].caseId + "</div>";
				htmlContent += "<div class='col-sm-2' style=" + bgcolor + ">" + data.rows[i].email + "</div>";
				htmlContent += "<div class='col-sm-2' style=" + bgcolor + ">" + data.rows[i].callerName + "</div>";
				htmlContent += "<div class='col-sm-7' style=" + bgcolor + ">" + data.rows[i].details + "</div>";
			}
			//htmlContent += "</div>";
			document.getElementById('renderSearch').innerHTML = htmlContent;
		}
		else {
			document.getElementById('renderSearch').innerHTML = "<div class='col-sm-12'></div>"
		}
	}
	function logger(log) {
		window.console&&console.info(log);
	}
</script>
</head>
<body>
	<div class="container">
		<h2 align="center">Search your catalog here...</h2>
		<form method="post" action="" name="catalogForm">
			<table align="center">
				<thead>
					<th></th>
				</thead>
				<tr>
					<td style="font-weight: bold;">Search :</td>
					<td style="font-weight: bold;">
						<select id="filterType">
							<option value="mobile">Mobile</option>
							<option value="email">Email</option>
							<option value="caseId">Case Id</option>
						</select>
					</td>
					<td><input type="text" name="searchText" id="searchText" /></td>
					<td><input type="submit" value="Search" /></td>
				</tr>
			</table>
		</form>
		<div class="container-fluid" style="margin:10px 0 15px 0;">
			<div class="table-responsive" id="renderSearch"></div>
		</div>
	</div>
</body>
</html>
